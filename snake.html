<!doctype html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LN5WKNMNR1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LN5WKNMNR1');
</script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Snake (with Swipe)</title>
  <style>
    :root { --bg:#0f1218; --fg:#eaf2ff; --muted:#a7b1c2; --accent:#7cc36b; }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    body { display: grid; place-items: center; background: var(--bg); color: var(--fg); font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    .wrap { width: 100%; max-width: 520px; padding: 20px; }
    h1 { margin: 0 0 10px; font-size: 22px; text-align: center; }
    .bar { display:flex; justify-content: space-between; align-items:center; margin: 8px 0 14px; font-size: 14px; color: var(--muted); }
    canvas { display:block; width:100%; height:auto; background: #141925; border: 2px solid #222b3a; border-radius: 12px; touch-action: none; }
    .hint { margin-top: 10px; font-size: 13px; color: var(--muted); text-align: center; }
    .btns { display:flex; gap:8px; justify-content:center; margin-top:10px; }
    button { background:#1c2332; color: var(--fg); border:1px solid #2a3447; padding:8px 12px; border-radius:10px; cursor:pointer; }
    button:hover { filter:brightness(1.1); }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>üêç Snake</h1>
    <div class="bar">
      <div>Score: <span id="score">0</span></div>
      <div>Best: <span id="best">0</span></div>
    </div>
    <canvas id="game" width="420" height="420" aria-label="Snake game" role="img"></canvas>
    <div class="btns">
      <button id="restart">Restart (Space)</button>
      <button id="pause">Pause (P)</button>
    </div>
    <p class="hint">Keyboard: arrows/WASD ‚Ä¢ Mobile: <b>swipe</b> on the board.</p>
  </div>

  <script>
    // Grid config
    const CELL = 20;                 // grid cell size (px)
    const COLS = 21, ROWS = 21;      // 420x420 canvas
    const SPEED = 120;               // ms per tick

    // DOM
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d', { alpha: false });
    const scoreEl = document.getElementById('score');
    const bestEl = document.getElementById('best');
    const btnRestart = document.getElementById('restart');
    const btnPause = document.getElementById('pause');

    // Game state
    let snake, dir, nextDir, food, score, best, loop, paused, dead;

    function randCell() {
      return { x: Math.floor(Math.random()*COLS), y: Math.floor(Math.random()*ROWS) };
    }

    function placeFood() {
      let f;
      do { f = randCell(); } while (snake.some(s => s.x === f.x && s.y === f.y));
      food = f;
    }

    function reset() {
      snake = [{x:10,y:10},{x:9,y:10},{x:8,y:10}];
      dir = {x:1,y:0};
      nextDir = dir;
      score = 0;
      paused = false;
      dead = false;
      scoreEl.textContent = score;
      placeFood();
      draw();
    }

    function tick() {
      if (paused || dead) return;
      dir = nextDir;

      const head = { x: snake[0].x + dir.x, y: snake[0].y + dir.y };

      // Collisions
      if (head.x < 0 || head.x >= COLS || head.y < 0 || head.y >= ROWS) { gameOver(); return; }
      if (snake.some(s => s.x === head.x && s.y === head.y)) { gameOver(); return; }

      snake.unshift(head);

      // Eat
      if (head.x === food.x && head.y === food.y) {
        score++;
        scoreEl.textContent = score;
        best = Math.max(best || 0, score);
        localStorage.setItem('snake-best', best);
        bestEl.textContent = best;
        placeFood();
      } else {
        snake.pop();
      }

      draw();
    }

    function draw() {
      // background
      ctx.fillStyle = '#0e1422';
      ctx.fillRect(0,0,canvas.width,canvas.height);

      // grid (subtle)
      ctx.strokeStyle = '#192236';
      ctx.lineWidth = 1;
      for (let x = CELL; x < canvas.width; x += CELL) {
        ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,canvas.height); ctx.stroke();
      }
      for (let y = CELL; y < canvas.height; y += CELL) {
        ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(canvas.width,y); ctx.stroke();
      }

      // food
      ctx.fillStyle = '#e06d6d';
      ctx.fillRect(food.x*CELL+2, food.y*CELL+2, CELL-4, CELL-4);

      // snake
      ctx.fillStyle = '#7cc36b';
      snake.forEach((s) => { ctx.fillRect(s.x*CELL+2, s.y*CELL+2, CELL-4, CELL-4); });

      if (paused) overlay('Paused');
      if (dead) overlay('Game Over');
    }

    function overlay(text) {
      ctx.fillStyle = 'rgba(0,0,0,0.5)';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#ffffff';
      ctx.font = 'bold 32px system-ui, -apple-system, Segoe UI, Roboto, Arial';
      ctx.textAlign = 'center';
      ctx.fillText(text, canvas.width/2, canvas.height/2);
      ctx.font = '14px system-ui, -apple-system, Segoe UI, Roboto, Arial';
      ctx.fillText('Press Space to restart', canvas.width/2, canvas.height/2 + 26);
    }

    function gameOver() {
      dead = true;
      draw();
    }

    function setDir(nx, ny) {
      // prevent reversing direction in one step
      if (dead) return;
      if (paused) paused = false;
      if (nx === -dir.x && ny === -dir.y) return;
      nextDir = {x:nx, y:ny};
    }

    // Keyboard controls
    window.addEventListener('keydown', e => {
      const k = e.key.toLowerCase();
      if (k === 'arrowup' || k === 'w') setDir(0,-1);
      else if (k === 'arrowdown' || k === 's') setDir(0,1);
      else if (k === 'arrowleft' || k === 'a') setDir(-1,0);
      else if (k === 'arrowright' || k === 'd') setDir(1,0);
      else if (k === ' ' ) { reset(); }
      else if (k === 'p') { paused = !paused; draw(); }
    }, { passive: true });

    // --- Swipe controls for mobile ---
    let touchStartX = 0, touchStartY = 0, touchMoved = false;
    const SWIPE_MIN = 24; // px threshold

    canvas.addEventListener('touchstart', (e) => {
      // prevent page scroll while swiping on canvas
      e.preventDefault();
      const t = e.changedTouches[0];
      touchStartX = t.clientX;
      touchStartY = t.clientY;
      touchMoved = false;
    }, { passive: false });

    canvas.addEventListener('touchmove', (e) => {
      e.preventDefault();
      touchMoved = true;
    }, { passive: false });

    canvas.addEventListener('touchend', (e) => {
      e.preventDefault();
      const t = e.changedTouches[0];
      const dx = t.clientX - touchStartX;
      const dy = t.clientY - touchStartY;

      if (!touchMoved) return;
      if (Math.abs(dx) < SWIPE_MIN && Math.abs(dy) < SWIPE_MIN) return;

      if (Math.abs(dx) > Math.abs(dy)) {
        // horizontal swipe
        if (dx > 0) setDir(1,0); else setDir(-1,0);
      } else {
        // vertical swipe
        if (dy > 0) setDir(0,1); else setDir(0,-1);
      }
    }, { passive: false });

    // Start
    best = Number(localStorage.getItem('snake-best') || 0);
    bestEl.textContent = best;
    reset();
    loop = setInterval(tick, SPEED);
  </script>
</body>
</html>
